Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<Developer`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<DiffusiveDynamics`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$VerbosePrint", "=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "\[Alpha]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], ",", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DDD", "[", 
    RowBox[{"Dx_", ",", "Dy_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Dx", "^", "2"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", 
        RowBox[{"Dy", "^", "2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D2DMat", "[", 
     RowBox[{"Dx_", ",", "Dy_", ",", "\[Alpha]_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"\[Alpha]", " ", "\[Degree]"}], "]"}], ".", 
       RowBox[{"DDD", "[", 
        RowBox[{"Dx", ",", "Dy"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"R", "[", 
         RowBox[{"\[Alpha]", " ", "\[Degree]"}], "]"}], "]"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5671673147720623`*^9, 3.567167331877041*^9}, {
  3.567167371279295*^9, 3.567167377979678*^9}, {3.567167428385561*^9, 
  3.567167428800585*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"STEPS", "=", "1000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STEP", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CELLRANGE", "=", 
    RowBox[{"{", 
     RowBox[{"1000.", ",", "500."}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"DIFFX", ",", "DIFFY", ",", "ALPHA"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DIFFX", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DIFFY", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", "5"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DIFFX", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"5", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x", "/", " ", 
          RowBox[{"CELLRANGE", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], " ", "\[Pi]"}], "]"}]}], " ", 
      "+", "10"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DIFFY", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"5", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"y", "/", " ", 
           RowBox[{"CELLRANGE", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[Pi]"}], "]"}]}], " ", 
       "+", "10"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ALPHA", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ALPHA", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "/", "2"}], ")"}], "/", 
           RowBox[{"CELLRANGE", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "/", "2"}], ")"}], "/", " ", 
           RowBox[{"CELLRANGE", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}]}], ")"}], "*",
       "180"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TENSOR", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"D2DMat", "[", 
    RowBox[{
     RowBox[{"DIFFX", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"DIFFY", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"ALPHA", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "ENERGY", "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"energija", " ", "v", " ", "enotah", " ", "kT"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ENERGY", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KT", "=", "1."}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.567167412352644*^9, 3.5671674150417976`*^9}, {
   3.567167521135866*^9, 3.5671675337035847`*^9}, {3.567169268001781*^9, 
   3.5671692682187934`*^9}, 3.567251427393649*^9, {3.56725478616776*^9, 
   3.567254802321684*^9}, {3.567254847120246*^9, 3.5672548662053375`*^9}, {
   3.5672556114899654`*^9, 3.5672556149311624`*^9}, {3.567255904645733*^9, 
   3.5672559046897354`*^9}, {3.5672559536865377`*^9, 3.567255954331575*^9}, {
   3.567256138548112*^9, 3.567256145218493*^9}, {3.5672562139494243`*^9, 
   3.5672562255350866`*^9}, {3.5672562582529583`*^9, 3.567256277137038*^9}, {
   3.567256331429144*^9, 3.567256333566266*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CELL$plots", "=", 
    RowBox[{"DiffusionParameters2DPlots", "[", 
     RowBox[{
     "DIFFX", ",", "DIFFY", ",", "ALPHA", ",", "ENERGY", ",", "CELLRANGE"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"StringForm", "[", 
    RowBox[{
    "\"\<STEPS `1`; STEP `2`; KT `3`\>\"", ",", "STEPS", ",", "STEP", ",", 
     "KT"}], "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.56716773381503*^9, 3.5671677461427355`*^9}, {
  3.5671677763804655`*^9, 3.5671677808777227`*^9}, {3.5671691366102657`*^9, 
  3.56716918337094*^9}, {3.567169263950549*^9, 3.5671692780803576`*^9}}],

Cell[BoxData["."], "Input",
 CellChangeTimes->{3.567255617549312*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.56717072505712*^9, {3.5672515703628263`*^9, 3.5672515780512657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$VerbosePrint", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.5671712836170673`*^9, 3.5671712887933636`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rw", "=", 
      RowBox[{"GenerateDiffusionTrajectory2D", "[", 
       RowBox[{
       "STEPS", ",", "DIFFX", ",", "DIFFY", ",", "ALPHA", ",", "ENERGY", ",", 
        "KT", ",", "STEP", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "CELLRANGE"}], ",", "CELLRANGE"}], "}"}], ",", 
        RowBox[{"Verbose", "\[Rule]", "True"}], ",", 
        RowBox[{"InitialPosition", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"rw", "[", 
    RowBox[{"[", 
     RowBox[{";;", "10"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.567251579058324*^9, 3.567251591635043*^9}, {
  3.567251723881607*^9, 3.5672517294839277`*^9}, {3.567254896703082*^9, 
  3.567254912453983*^9}, {3.567256176688293*^9, 3.5672561944713097`*^9}, {
  3.5672569457062783`*^9, 3.567256979283199*^9}, {3.567257568953926*^9, 
  3.5672575988396354`*^9}, {3.5672578438366485`*^9, 3.5672578461287794`*^9}, {
  3.5672579938482285`*^9, 3.567258064400264*^9}}],

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rw", "=", 
    RowBox[{"ParallelGenerateDiffusionTrajectory2D", "[", 
     RowBox[{
     "STEPS", ",", "DIFFX", ",", "DIFFY", ",", "ALPHA", ",", "ENERGY", ",", 
      "KT", ",", "STEP", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "CELLRANGE"}], ",", "CELLRANGE"}], "}"}], ",", 
      RowBox[{"\"\<ThreadCount\>\"", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.567167606805766*^9, {3.567170928953782*^9, 3.5671709346651087`*^9}, {
   3.567171295314737*^9, 3.567171295479746*^9}}],

Cell[BoxData[
 RowBox[{"StrideData", "[", 
  RowBox[{
   RowBox[{"rw", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"1", ";;", "100"}]}], "]"}], "]"}], ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.5671694704503603`*^9, 3.567169520072199*^9}, {
  3.567169620118921*^9, 3.5671696726079235`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"rw", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{";;", ";;", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"STEPS", "/", "10000"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "CELLRANGE"}], ",", "CELLRANGE"}], "}"}]}]}], ",", 
   RowBox[{"GridLinesStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Red", ",", "Thick", ",", "Dashed"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.567169294047271*^9, 3.567169295900377*^9}, {
   3.567170099397334*^9, 3.5671701445079145`*^9}, 3.567170218144126*^9}],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"InputNotebook", "[", "]"}], ",", 
    RowBox[{"PrivateNotebookOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "False"}], "}"}]}], ",", 
    RowBox[{"TrackCellChangeTimes", "\[Rule]", "False"}]}], "]"}]}]], "Input"]
},
WindowSize->{1006, 551},
WindowMargins->{{0, Automatic}, {0, Automatic}},
PrivateNotebookOptions->{"FileOutlineCache"->False,
"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
TrackCellChangeTimes->False,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False
]

